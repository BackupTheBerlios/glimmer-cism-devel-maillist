<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Glimmer-cism-devel] build system for glimmer-cism
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/glimmer-cism-devel/2009-August/index.html" >
   <LINK REL="made" HREF="mailto:glimmer-cism-devel%40lists.berlios.de?Subject=Re%3A%20%5BGlimmer-cism-devel%5D%20build%20system%20for%20glimmer-cism&In-Reply-To=%3C30F7A154-77D9-4372-9942-5097592025AD%40lanl.gov%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000035.html">
   <LINK REL="Next"  HREF="000030.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Glimmer-cism-devel] build system for glimmer-cism</H1>
    <B>William Lipscomb</B> 
    <A HREF="mailto:glimmer-cism-devel%40lists.berlios.de?Subject=Re%3A%20%5BGlimmer-cism-devel%5D%20build%20system%20for%20glimmer-cism&In-Reply-To=%3C30F7A154-77D9-4372-9942-5097592025AD%40lanl.gov%3E"
       TITLE="[Glimmer-cism-devel] build system for glimmer-cism">lipscomb at lanl.gov
       </A><BR>
    <I>Wed Aug 26 15:32:40 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000035.html">[Glimmer-cism-devel] build system for glimmer-cism
</A></li>
        <LI>Next message: <A HREF="000030.html">[Glimmer-cism-devel] directory structure for glimmer-cism v2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28">[ date ]</a>
              <a href="thread.html#28">[ thread ]</a>
              <a href="subject.html#28">[ subject ]</a>
              <a href="author.html#28">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi Ian and Magi,

I know very little about build systems, but I share Ian's concern that  
we need to be able to build Glimmer-CISM within coupled models (and  
not just copy previously built code) .  Ian, you're welcome to copy  
our exchange to the mailing list.  Magi and others may have some  
useful ideas.

Cheers,

Bill


On Aug 26, 2009, at 7:22 AM, Ian Rutt wrote:

&gt;<i>
</I>&gt;<i> Hi Magi,
</I>&gt;<i>
</I>&gt;<i> Thanks for taking a look at Scons. It sounds interesting, although
</I>&gt;<i> I've not had a chance to look at the website further.
</I>&gt;<i>
</I>&gt;<i> The main concern I have is how changing the build system will impact
</I>&gt;<i> the use of Glimmer-CISM within coupled models (i.e. CCSM, GENIE and
</I>&gt;<i> HadCM3/FAMOUS). This is often the most problematic part of integrating
</I>&gt;<i> with these models, and I would be very cautious about making a radical
</I>&gt;<i> change. For coupled models, how one interacts with the build is almost
</I>&gt;<i> as important as how one calls the code. So, I think changing the build
</I>&gt;<i> system is akin to changing the API - it should only be done if
</I>&gt;<i> absolutely necessary, and with wide consultation.
</I>&gt;<i>
</I>&gt;<i> So, I would instead suggest we think more broadly about how we make
</I>&gt;<i> interaction with coupled models more streamlined.  Bill and I have
</I>&gt;<i> been talking in the last day or two about the broader problems of
</I>&gt;<i> maintaining a model which is both a component of a particular coupled
</I>&gt;<i> model and a stand-alone project (i.e. as Glimmer-CISM is w.r.t.
</I>&gt;<i> multiple coupled models). I'll copy the relevant bits of that exchange
</I>&gt;<i> to the mailing list - hope that's OK, Bill.
</I>&gt;<i>
</I>&gt;<i> I agree that autotools is non-ideal, but I'm not sure that introducing
</I>&gt;<i> extra dependencies to the build is the way forward. I guess the
</I>&gt;<i> crucial question is this - are we sufficiently fed up with the
</I>&gt;<i> limitations of the existing system to make it worth the pain of
</I>&gt;<i> changing it?
</I>&gt;<i>
</I>&gt;<i> But - let's continue to talk about this.
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i>
</I>&gt;<i> Ian
</I>&gt;<i>
</I>&gt;<i> On 26 Aug 2009, at 10:57, Magnus Hagdorn wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi all,
</I>&gt;&gt;<i> at the ice sheet modelling summer school in Portland a student,
</I>&gt;&gt;<i> Stefano,
</I>&gt;&gt;<i> suggested to use scons[1] instead of the GNU autotools. He also
</I>&gt;&gt;<i> partially ported the current build system to scons.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Scons seems to be fairly capable. It can compile C, C++, Fortran code
</I>&gt;&gt;<i> and supports TeX and LaTeX. It supports dependency tracking including
</I>&gt;&gt;<i> Fortran out of the box. It will build project files for MS Visual
</I>&gt;&gt;<i> Studio. It is written in python, configuration files are actual  
</I>&gt;&gt;<i> python
</I>&gt;&gt;<i> scripts.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> So far so good, however, I have some reservations:
</I>&gt;&gt;<i> * it is a new system to learn and ok autotools are a pain. However
</I>&gt;&gt;<i> once
</I>&gt;&gt;<i> the system is setup it is merely a matter of editing the Makefile.am
</I>&gt;&gt;<i> which is suitably like a normal Makefile
</I>&gt;&gt;<i> * it introduces a new dependency. People who want to compile
</I>&gt;&gt;<i> glimmer-cism from source will need to have scons installed. The
</I>&gt;&gt;<i> current
</I>&gt;&gt;<i> build system consists only of shell scripts. The autotools are only
</I>&gt;&gt;<i> required if the build system itself is changed.
</I>&gt;&gt;<i> * we autogenerate many files. This would need to be coded in python.
</I>&gt;&gt;<i> This is not a major problem but needs to be done which is an
</I>&gt;&gt;<i> additional
</I>&gt;&gt;<i> effort.
</I>&gt;&gt;<i> * there are many autoconf macros which can be used to detect
</I>&gt;&gt;<i> libraries,
</I>&gt;&gt;<i> features, etc. We would need to teach that scons. There is lots of
</I>&gt;&gt;<i> documentation for the autotools.
</I>&gt;&gt;<i> * I don't understand how a particular compilation is configured. Do
</I>&gt;&gt;<i> you
</I>&gt;&gt;<i> have to program command line options (not a problem but needs to be
</I>&gt;&gt;<i> done), set environment variables? Is the user configuration stored
</I>&gt;&gt;<i> somewhere like in config.log?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> There is an interesting article on lwn.net [2] which discusses how  
</I>&gt;&gt;<i> the
</I>&gt;&gt;<i> KDE project to use cmake [3] instead of scons to escape the autohell.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> My view is that
</I>&gt;&gt;<i> * autotools work and do everything we want them to
</I>&gt;&gt;<i> * I am happy to change the autoconf stuff to meet new requirements.  
</I>&gt;&gt;<i> So
</I>&gt;&gt;<i> far other developers seem to have coped adjusting the Makefile.am
</I>&gt;&gt;<i> files.
</I>&gt;&gt;<i> * being able to support MS Visual Studio might be desirable
</I>&gt;&gt;<i> * we can discuss switching to scons if someone does a complete port  
</I>&gt;&gt;<i> of
</I>&gt;&gt;<i> the build system to scons and can demonstrate that everything works  
</I>&gt;&gt;<i> as
</I>&gt;&gt;<i> it should.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The question is should we encourage someone to spend effort on this
</I>&gt;&gt;<i> port
</I>&gt;&gt;<i> or not?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Cheers
</I>&gt;&gt;<i> magi
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [1] <A HREF="http://www.scons.org/">http://www.scons.org/</A>
</I>&gt;&gt;<i> [2] <A HREF="http://lwn.net/Articles/188693/">http://lwn.net/Articles/188693/</A>
</I>&gt;&gt;<i> [3] <A HREF="http://www.cmake.org/">http://www.cmake.org/</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -- 
</I>&gt;&gt;<i> The University of Edinburgh is a charitable body, registered in
</I>&gt;&gt;<i> Scotland, with registration number SC005336.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Glimmer-cism-devel mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/glimmer-cism-devel">Glimmer-cism-devel at lists.berlios.de</A>
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/glimmer-cism-devel">https://lists.berlios.de/mailman/listinfo/glimmer-cism-devel</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Glimmer-cism-devel mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/glimmer-cism-devel">Glimmer-cism-devel at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/glimmer-cism-devel">https://lists.berlios.de/mailman/listinfo/glimmer-cism-devel</A>
</I>
*******************************************************************************
William H. Lipscomb					E-mail: <A HREF="https://lists.berlios.de/mailman/listinfo/glimmer-cism-devel">lipscomb at lanl.gov</A>
Los Alamos National Laboratory		Phone: (505) 667-0395
Group T-3, Mail Stop B216			Fax: (505) 665-5926
Los Alamos, NM 87545
*******************************************************************************





</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000035.html">[Glimmer-cism-devel] build system for glimmer-cism
</A></li>
	<LI>Next message: <A HREF="000030.html">[Glimmer-cism-devel] directory structure for glimmer-cism v2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28">[ date ]</a>
              <a href="thread.html#28">[ thread ]</a>
              <a href="subject.html#28">[ subject ]</a>
              <a href="author.html#28">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/glimmer-cism-devel">More information about the Glimmer-cism-devel
mailing list</a><br>
</body></html>
