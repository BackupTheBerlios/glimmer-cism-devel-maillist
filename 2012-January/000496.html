<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Glimmer-cism-devel] changes in scaling of variables on netcdf output
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/glimmer-cism-devel/2012-January/index.html" >
   <LINK REL="made" HREF="mailto:glimmer-cism-devel%40lists.berlios.de?Subject=Re%3A%20%5BGlimmer-cism-devel%5D%20changes%20in%20scaling%20of%20variables%20on%20netcdf%0A%20output&In-Reply-To=%3C4F141D1E.8060008%40swansea.ac.uk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000495.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Glimmer-cism-devel] changes in scaling of variables on netcdf output</H1>
    <B>Ian Rutt</B> 
    <A HREF="mailto:glimmer-cism-devel%40lists.berlios.de?Subject=Re%3A%20%5BGlimmer-cism-devel%5D%20changes%20in%20scaling%20of%20variables%20on%20netcdf%0A%20output&In-Reply-To=%3C4F141D1E.8060008%40swansea.ac.uk%3E"
       TITLE="[Glimmer-cism-devel] changes in scaling of variables on netcdf output">I.C.Rutt at swansea.ac.uk
       </A><BR>
    <I>Mon Jan 16 13:50:38 CET 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000495.html">[Glimmer-cism-devel] changes in scaling of variables on netcdf	output
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#496">[ date ]</a>
              <a href="thread.html#496">[ thread ]</a>
              <a href="subject.html#496">[ subject ]</a>
              <a href="author.html#496">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi Steve,

I don't have much insight beyond this: the netcdf IO code is 
automatically generated from a template. I would suggest this is the 
most likely place to look - either in the python code that does the 
task, or the template itself.

The script is generate_ncvars.py

Actually, I'm not sure if there is a template. Looking at the script and 
the makefiles would answer the questions.

Cheers,

Ian

Dr Ian Rutt
Department of Geography
College of Science
Swansea University
Singleton Park
Swansea
SA2 8PP
Tel. +44 (0)1792 602685
<A HREF="https://lists.berlios.de/mailman/listinfo/glimmer-cism-devel">i.c.rutt at swansea.ac.uk</A>

On 13/01/12 23:10, Stephen F. Price wrote:
&gt;<i>
</I>&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> A year or so ago (longer?) there was discussion about changing the way non-dim variables in the code were scaled back up to dimensional values just before, or during output to netCDF. The changes were implemented some time ago on one of the Berlios repository branches and have persisted every since.
</I>&gt;<i>
</I>&gt;<i> Currently, we are seeing a problem on some branches of the code - which were merged with / from older Berlios branches - whereby output looks to be scaled up to dimensional, twice. That is, all output variables in netcdf appear too large (or too small) by a factor exactly equal to the scale factor. When doing an ncdump, one can see that the variables are already dimensional in the netcdf file (when they should not be). Thus, when they are multiplied again by the scale factor, e.g. for viewing w/ something like ncview, what you actually see is the value:
</I>&gt;<i>
</I>&gt;<i> variable * scale_factor * scale_factor
</I>&gt;<i>
</I>&gt;<i> What should be happening is that the non-dim values are written to the netcdf file so that scaling back up to dimensional is explicitly applied (e.g., in matlab one would not only import that values but the scale factor, in order to work w/ dimensional output).
</I>&gt;<i>
</I>&gt;<i> It looks like the original changes (or at least some of them) were made by Magi, on Berlios, rev. 1491, in Feb. of last year. My hunch is that some older piece of code is still hanging around, applying the scales to the variables before the netcdf write routines are called.
</I>&gt;<i>
</I>&gt;<i> Please let me know if anyone has ideas for where to start hunting this bug down.
</I>&gt;<i>
</I>&gt;<i> thanks -
</I>&gt;<i>
</I>&gt;<i> Steve
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Glimmer-cism-devel mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/glimmer-cism-devel">Glimmer-cism-devel at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/glimmer-cism-devel">https://lists.berlios.de/mailman/listinfo/glimmer-cism-devel</A>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000495.html">[Glimmer-cism-devel] changes in scaling of variables on netcdf	output
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#496">[ date ]</a>
              <a href="thread.html#496">[ thread ]</a>
              <a href="subject.html#496">[ subject ]</a>
              <a href="author.html#496">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/glimmer-cism-devel">More information about the Glimmer-cism-devel
mailing list</a><br>
</body></html>
